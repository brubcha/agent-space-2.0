{% extends "base.html" %}
{% block title %}New Request - AgentSpace{% endblock %}
{% block content %}
<h1 style="margin-bottom: 30px;">Create New Request</h1>

<div class="card">
    <form method="POST" enctype="multipart/form-data" id="requestForm">
        <div class="form-group">
            <label>Request Type</label>
            <select name="request_type">
                <option value="Marketing Kit">Marketing Kit</option>
                <option value="Brand Strategy">Brand Strategy</option>
                <option value="Content Calendar">Content Calendar</option>
            </select>
        </div>
        
        <div class="form-group">
            <label>Client Name *</label>
            <input type="text" name="client_name" required placeholder="Acme Corp">
        </div>
        
        <div class="form-group">
            <label>Website</label>
            <input type="url" name="website" placeholder="https://example.com">
        </div>
        
        <div class="form-group">
            <label>Offerings</label>
            <textarea name="offerings" placeholder="List the client's products/services (one per line or comma-separated)"></textarea>
        </div>
        
        <div class="form-group">
            <label>Competitors</label>
            <textarea name="competitors" placeholder="List main competitors (one per line or comma-separated)"></textarea>
        </div>
        
        <div class="form-group">
            <label>Additional Information</label>
            <textarea name="additional_info" placeholder="Any other relevant information about the client, their industry, target audience, brand personality, etc."></textarea>
        </div>
        
        <div class="form-group">
            <label>Upload Files (Brand assets, documents, etc.)</label>
            <div class="drop-zone" id="dropZone">
                <p>ðŸ“Ž Drag and drop files here or click to browse</p>
                <p style="color: #999; font-size: 14px; margin-top: 10px;">Supported: PDF, DOCX, Images, etc. (Max 50MB)</p>
                <input type="file" name="files" id="fileInput" multiple style="display: none;">
            </div>
            <div class="file-list" id="fileList"></div>
        </div>
        
        <div style="display: flex; gap: 15px;">
            <button type="submit" class="btn">ðŸš€ Generate Marketing Kit</button>
            <a href="{{ url_for('dashboard') }}" class="btn btn-secondary">Cancel</a>
        </div>
    </form>
</div>

<script>
const dropZone = document.getElementById('dropZone');
const fileInput = document.getElementById('fileInput');
const fileList = document.getElementById('fileList');

dropZone.addEventListener('click', () => fileInput.click());

dropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropZone.classList.add('dragover');
});

dropZone.addEventListener('dragleave', () => dropZone.classList.remove('dragover'));

dropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    dropZone.classList.remove('dragover');
    fileInput.files = e.dataTransfer.files;
    displayFiles();
});

fileInput.addEventListener('change', displayFiles);

function displayFiles() {
    fileList.innerHTML = '';
    const files = fileInput.files;
    if (files.length > 0) {
        Array.from(files).forEach((file, index) => {
            const div = document.createElement('div');
            div.className = 'file-item';
            div.innerHTML = `
                <span>ðŸ“„ ${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)</span>
                <button type="button" onclick="removeFile(${index})">Remove</button>
            `;
            fileList.appendChild(div);
        });
    }
}

function removeFile(index) {
    const dt = new DataTransfer();
    const files = fileInput.files;
    for (let i = 0; i < files.length; i++) {
        if (i !== index) dt.items.add(files[i]);
    }
    fileInput.files = dt.files;
    displayFiles();
}
</script>
{% endblock %}
